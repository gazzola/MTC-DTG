 Por este motivo, a igreja mudou sua denominação para igreja de Nossa Senhora do Bonsucesso.. 
Em 1638, passou, pela cidade, o padre jesuíta peruano Antonio Ruiz de Montoya em sua viagem até a Europa, procedente das missões jesuíticas do Paraguai. Montoya iria se queixar, perante as autoridades europeias, sobre os ataques dos bandeirantes paulistas às missões jesuítas no interior do continente. Montoya se notabilizaria por ter escrito a primeira gramática da língua guarani, o "Tesoro de la Lengua Guaraní", que viria a ser publicada no ano seguinte, em Madri, na Espanha. Em 1639, novamente o temor de um ataque neerlandês levou à reforma da fortaleza na Ilha das Cobras, que passou a se chamar fortaleza de Santa Margarida da Ilha das Cobras, em homenagem à vice-rainha de Portugal, Margarida de Saboia. No mesmo ano, negros (escravos e alforriados) fundaram a confraria de Nossa Senhora do Rosário, tendo, como santa de devoção, a imagem de Nossa Senhora do Rosário que se localizava na igreja de São Sebastião, no morro do Castelo. Em 1641, a cidade comemorou a coroação de dom João V como rei de Portugal com a encenação de uma peça no largo do Paço. Em 1644, foi criada a freguesia de Irajá. Em 1645, uma expedição chefiada por Francisco de Souto Maior partiu da cidade para lutar contra a dominação neerlandesa de Angola. Em 26 de novembro de 1646, a câmara de vereadores da cidade decidiu angariar recursos através de doações e da venda de terrenos no litoral entre a Praia de Santa Luzia e o Morro de São Bento, objetivando a ampliação da fortaleza na ilha da Lage, na entrada da baía de Guanabara. A medida era preventiva contra uma eventual invasão neerlandesa, já que estes haviam acabado de invadir o nordeste brasileiro. Em 1648, uma frota de quinze navios com 1 400 homens sob o comando de Salvador Correia de Sá e Benevides, filho de Martim Correia de Sá, partiu da cidade com destino a Angola e São Tomé e Príncipe, na África. O seu objetivo era recuperar essas possessões portuguesas, então sob controle neerlandês. A população da cidade financiou a expedição com a quantia de 60 000 cruzados. Era importante recuperar o controle português em Angola, pois era de lá que vinha a maior parte dos escravos utilizados nos engenhos de cana-de-açúcar brasileiros da época: era o chamado "ciclo de Angola" do tráfico negreiro, que durou todo o século 17. A expedição foi vitoriosa, desfechando um poderoso golpe contra as possessões neerlandesas no nordeste brasileiro, que perderam sua principal fonte de mão de obra escrava. Durante todo o século, a cidade teve papel destacado na luta contra as invasões neerlandesas na África e no nordeste brasileiro. Salvador Correia de Sá e Benevides fazia parte da família do fundador da cidade, Estácio de Sá. A família Sá possuía extensas plantações de cana-de-açúcar na região do atual bairro de São Conrado, geridas com mão de obra escrava. Em meados do século, a rua Antônio Nabo, que ligava o porto ao morro de Santo Antônio, passou a ser chamada de rua São José, por passar ao lado da igreja homônima. Em 1667, a confraria de Nossa Senhora do Rosário se uniu à confraria de São Benedito (também formada por negros) para formar a Irmandade de Nossa Senhora do Rosário e São Benedito dos Homens Pretos, também sediada no morro do Castelo. Ao longo do século, foi formada, por aterro, a praia Vermelha, na Urca. Ela uniu, ao continente, a ilha que era constituída pelos morros Cara de Cão, Pão de Açúcar e Urca.